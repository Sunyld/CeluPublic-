{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/PROJECTOS/Reactjs/Celu/project-bolt-sb1-r7qsskrc/funcional/project/components/ui/input.tsx"],"sourcesContent":["import * as React from 'react';\nimport { cn } from '@/lib/utils';\n\nexport interface InputProps\n  extends React.InputHTMLAttributes<HTMLInputElement> {}\n\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          'flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nInput.displayName = 'Input';\n\nexport { Input };\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAKA,MAAM,sBAAQ,4PAAgB,MAC5B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,8QAAC;QACC,MAAM;QACN,WAAW,IAAA,sMAAE,EACX,gWACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,MAAM,WAAW,GAAG"}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///D:/PROJECTOS/Reactjs/Celu/project-bolt-sb1-r7qsskrc/funcional/project/components/ui/label.tsx"],"sourcesContent":["import * as React from 'react';\nimport { cn } from '@/lib/utils';\n\nexport interface LabelProps\n  extends React.LabelHTMLAttributes<HTMLLabelElement> {}\n\nconst Label = React.forwardRef<HTMLLabelElement, LabelProps>(\n  ({ className, ...props }, ref) => (\n    <label\n      ref={ref}\n      className={cn(\n        'text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70',\n        className\n      )}\n      {...props}\n    />\n  )\n);\nLabel.displayName = 'Label';\n\nexport { Label };\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAKA,MAAM,sBAAQ,4PAAgB,MAC5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACxB,8QAAC;QACC,KAAK;QACL,WAAW,IAAA,sMAAE,EACX,8FACA;QAED,GAAG,KAAK;;;;;;;AAIf,MAAM,WAAW,GAAG"}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///D:/PROJECTOS/Reactjs/Celu/project-bolt-sb1-r7qsskrc/funcional/project/components/ui/dialog.tsx"],"sourcesContent":["import * as React from 'react';\nimport * as DialogPrimitive from '@radix-ui/react-dialog';\nimport { X } from 'lucide-react';\nimport { cn } from '@/lib/utils';\n\nconst Dialog = DialogPrimitive.Root;\nconst DialogTrigger = DialogPrimitive.Trigger;\nconst DialogPortal = DialogPrimitive.Portal;\nconst DialogClose = DialogPrimitive.Close;\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      'fixed inset-0 z-[101] bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',\n      className\n    )}\n    {...props}\n  />\n));\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName;\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        'fixed left-1/2 top-1/2 z-[101] grid max-h-[calc(100%-4rem)] w-full -translate-x-1/2 -translate-y-1/2 gap-4 overflow-y-auto border bg-background p-6 shadow-lg shadow-black/5 duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:max-w-[400px] sm:rounded-xl',\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-3 top-3 flex size-7 items-center justify-center rounded-lg opacity-60 transition-opacity hover:opacity-100 focus:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Fechar</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n));\nDialogContent.displayName = DialogPrimitive.Content.displayName;\n\nconst DialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (\n  <div className={cn('flex flex-col space-y-1.5 text-center sm:text-left', className)} {...props} />\n);\nDialogHeader.displayName = 'DialogHeader';\n\nconst DialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn('flex flex-col-reverse gap-2 sm:flex-row sm:justify-end sm:gap-3', className)}\n    {...props}\n  />\n);\nDialogFooter.displayName = 'DialogFooter';\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn('text-lg font-semibold tracking-tight', className)}\n    {...props}\n  />\n));\nDialogTitle.displayName = DialogPrimitive.Title.displayName;\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn('text-sm text-muted-foreground', className)}\n    {...props}\n  />\n));\nDialogDescription.displayName = DialogPrimitive.Description.displayName;\n\nexport {\n  Dialog,\n  DialogClose,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogOverlay,\n  DialogPortal,\n  DialogTitle,\n  DialogTrigger,\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;;;;;;AAEA,MAAM,SAAS,8PAAoB;AACnC,MAAM,gBAAgB,iQAAuB;AAC7C,MAAM,eAAe,gQAAsB;AAC3C,MAAM,cAAc,+PAAqB;AAEzC,MAAM,8BAAgB,4PAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8QAAC,iQAAuB;QACtB,KAAK;QACL,WAAW,IAAA,sMAAE,EACX,6JACA;QAED,GAAG,KAAK;;;;;;KAVP;AAaN,cAAc,WAAW,GAAG,iQAAuB,CAAC,WAAW;AAE/D,MAAM,8BAAgB,4PAAgB,OAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,8QAAC;;0BACC,8QAAC;;;;;0BACD,8QAAC,iQAAuB;gBACtB,KAAK;gBACL,WAAW,IAAA,sMAAE,EACX,yjBACA;gBAED,GAAG,KAAK;;oBAER;kCACD,8QAAC,+PAAqB;wBAAC,WAAU;;0CAC/B,8QAAC,qRAAC;gCAAC,WAAU;;;;;;0CACb,8QAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;;AAKlC,cAAc,WAAW,GAAG,iQAAuB,CAAC,WAAW;AAE/D,MAAM,eAAe,CAAC,EAAE,SAAS,EAAE,GAAG,OAA6C,iBACjF,8QAAC;QAAI,WAAW,IAAA,sMAAE,EAAC,sDAAsD;QAAa,GAAG,KAAK;;;;;;MAD1F;AAGN,aAAa,WAAW,GAAG;AAE3B,MAAM,eAAe,CAAC,EAAE,SAAS,EAAE,GAAG,OAA6C,iBACjF,8QAAC;QACC,WAAW,IAAA,sMAAE,EAAC,mEAAmE;QAChF,GAAG,KAAK;;;;;;MAHP;AAMN,aAAa,WAAW,GAAG;AAE3B,MAAM,4BAAc,4PAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8QAAC,+PAAqB;QACpB,KAAK;QACL,WAAW,IAAA,sMAAE,EAAC,wCAAwC;QACrD,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,+PAAqB,CAAC,WAAW;AAE3D,MAAM,kCAAoB,4PAAgB,OAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8QAAC,qQAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,sMAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,qQAA2B,CAAC,WAAW"}},
    {"offset": {"line": 229, "column": 0}, "map": {"version":3,"sources":["file:///D:/PROJECTOS/Reactjs/Celu/project-bolt-sb1-r7qsskrc/funcional/project/components/shared/ConfirmDialog.tsx"],"sourcesContent":["import {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { AppButton } from '@/components/ui/app-button';\nimport { Loader2 } from 'lucide-react';\n\nexport interface ConfirmDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  title: string;\n  description: string;\n  confirmLabel?: string;\n  cancelLabel?: string;\n  onConfirm: () => void | Promise<void>;\n  destructive?: boolean;\n  loading?: boolean;\n}\n\n/**\n * Reusable confirmation dialog for destructive or important actions.\n * Supports async onConfirm; focus is managed by Radix Dialog.\n */\nexport function ConfirmDialog({\n  open,\n  onOpenChange,\n  title,\n  description,\n  confirmLabel = 'Eliminar',\n  cancelLabel = 'Cancelar',\n  onConfirm,\n  destructive = true,\n  loading = false,\n}: ConfirmDialogProps) {\n  const handleConfirm = async () => {\n    await onConfirm();\n    onOpenChange(false);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-[calc(100vw-2rem)] sm:max-w-[400px]\" onPointerDownOutside={(e) => e.preventDefault()}>\n        <DialogHeader>\n          <DialogTitle>{title}</DialogTitle>\n          <DialogDescription>{description}</DialogDescription>\n        </DialogHeader>\n        <DialogFooter className=\"gap-2 sm:gap-0\">\n          <AppButton\n            type=\"button\"\n            variant=\"outline\"\n            onClick={() => onOpenChange(false)}\n            disabled={loading}\n          >\n            {cancelLabel}\n          </AppButton>\n          <AppButton\n            type=\"button\"\n            variant={destructive ? 'destructive' : 'default'}\n            onClick={handleConfirm}\n            disabled={loading}\n            className=\"gap-2\"\n          >\n            {loading && <Loader2 className=\"h-4 w-4 animate-spin\" />}\n            {confirmLabel}\n          </AppButton>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AAQA;AACA;;;;;AAkBO,SAAS,cAAc,EAC5B,IAAI,EACJ,YAAY,EACZ,KAAK,EACL,WAAW,EACX,eAAe,UAAU,EACzB,cAAc,UAAU,EACxB,SAAS,EACT,cAAc,IAAI,EAClB,UAAU,KAAK,EACI;IACnB,MAAM,gBAAgB;QACpB,MAAM;QACN,aAAa;IACf;IAEA,qBACE,8QAAC,yNAAM;QAAC,MAAM;QAAM,cAAc;kBAChC,cAAA,8QAAC,gOAAa;YAAC,WAAU;YAA4C,sBAAsB,CAAC,IAAM,EAAE,cAAc;;8BAChH,8QAAC,+NAAY;;sCACX,8QAAC,8NAAW;sCAAE;;;;;;sCACd,8QAAC,oOAAiB;sCAAE;;;;;;;;;;;;8BAEtB,8QAAC,+NAAY;oBAAC,WAAU;;sCACtB,8QAAC,mOAAS;4BACR,MAAK;4BACL,SAAQ;4BACR,SAAS,IAAM,aAAa;4BAC5B,UAAU;sCAET;;;;;;sCAEH,8QAAC,mOAAS;4BACR,MAAK;4BACL,SAAS,cAAc,gBAAgB;4BACvC,SAAS;4BACT,UAAU;4BACV,WAAU;;gCAET,yBAAW,8QAAC,gTAAO;oCAAC,WAAU;;;;;;gCAC9B;;;;;;;;;;;;;;;;;;;;;;;;AAMb;KA9CgB"}},
    {"offset": {"line": 338, "column": 0}, "map": {"version":3,"sources":["file:///D:/PROJECTOS/Reactjs/Celu/project-bolt-sb1-r7qsskrc/funcional/project/hooks/useStorageImage.ts"],"sourcesContent":["/**\n * Hook to resolve storage image URL asynchronously.\n * Handles both public and private buckets, normalizes paths/URLs.\n * \n * Usage:\n *   const { url, loading, error } = useStorageImage('banner-images', banner.imagePath);\n *   <img src={url || placeholder} />\n */\n\nimport { useEffect, useState } from 'react';\nimport { resolveStorageUrl } from '@/lib/storageHelpers';\n\ntype UseStorageImageResult = {\n  url: string;\n  loading: boolean;\n  error: string | null;\n};\n\nexport function useStorageImage(\n  bucket: string,\n  pathOrUrl: string | null | undefined,\n  options?: { preferSigned?: boolean }\n): UseStorageImageResult {\n  const [url, setUrl] = useState<string>('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!pathOrUrl) {\n      setUrl('');\n      setLoading(false);\n      setError(null);\n      return;\n    }\n\n    let cancelled = false;\n\n    const resolve = async () => {\n      setLoading(true);\n      setError(null);\n\n      try {\n        const resolvedUrl = await resolveStorageUrl(bucket, pathOrUrl, options);\n        if (!cancelled) {\n          setUrl(resolvedUrl);\n          setLoading(false);\n          if (!resolvedUrl) {\n            setError('Failed to resolve image URL');\n          }\n        }\n      } catch (err: any) {\n        if (!cancelled) {\n          if (process.env.NODE_ENV === 'development') {\n            // eslint-disable-next-line no-console\n            console.error('[useStorageImage] Error resolving URL:', {\n              bucket,\n              pathOrUrl,\n              error: err?.message,\n            });\n          }\n          setError(err?.message || 'Failed to load image');\n          setUrl('');\n          setLoading(false);\n        }\n      }\n    };\n\n    resolve();\n\n    return () => {\n      cancelled = true;\n    };\n  }, [bucket, pathOrUrl, options?.preferSigned]);\n\n  return { url, loading, error };\n}\n"],"names":[],"mappings":";;;;AAoDc;AApDd;;;;;;;CAOC,GAED;AACA;;;;AAQO,SAAS,gBACd,MAAc,EACd,SAAoC,EACpC,OAAoC;;IAEpC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,0PAAQ,EAAS;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,0PAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,0PAAQ,EAAgB;IAElD,IAAA,2PAAS;qCAAC;YACR,IAAI,CAAC,WAAW;gBACd,OAAO;gBACP,WAAW;gBACX,SAAS;gBACT;YACF;YAEA,IAAI,YAAY;YAEhB,MAAM;qDAAU;oBACd,WAAW;oBACX,SAAS;oBAET,IAAI;wBACF,MAAM,cAAc,MAAM,IAAA,8NAAiB,EAAC,QAAQ,WAAW;wBAC/D,IAAI,CAAC,WAAW;4BACd,OAAO;4BACP,WAAW;4BACX,IAAI,CAAC,aAAa;gCAChB,SAAS;4BACX;wBACF;oBACF,EAAE,OAAO,KAAU;wBACjB,IAAI,CAAC,WAAW;4BACd,wCAA4C;gCAC1C,sCAAsC;gCACtC,QAAQ,KAAK,CAAC,0CAA0C;oCACtD;oCACA;oCACA,OAAO,KAAK;gCACd;4BACF;4BACA,SAAS,KAAK,WAAW;4BACzB,OAAO;4BACP,WAAW;wBACb;oBACF;gBACF;;YAEA;YAEA;6CAAO;oBACL,YAAY;gBACd;;QACF;oCAAG;QAAC;QAAQ;QAAW,SAAS;KAAa;IAE7C,OAAO;QAAE;QAAK;QAAS;IAAM;AAC/B;GAzDgB"}},
    {"offset": {"line": 425, "column": 0}, "map": {"version":3,"sources":["file:///D:/PROJECTOS/Reactjs/Celu/project-bolt-sb1-r7qsskrc/funcional/project/app/admin/banners/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { useApp } from '@/context/AppContext';\r\nimport { useToast } from '@/context/ToastContext';\r\nimport { getBannersRepo } from '@/lib/repositories/getBannersRepo';\r\nimport type { Banner } from '@/types';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { AppButton } from '@/components/ui/app-button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog';\r\nimport { ImagePlus, Trash2, ToggleLeft, ToggleRight, Upload, Loader2 } from 'lucide-react';\r\nimport { getMessageForError } from '@/lib/errors';\r\nimport { useStorageImage } from '@/hooks/useStorageImage';\r\n\r\nconst RESOLUTIONS = {\r\n    desktop: '1920×480px (proporção ~4:1)',\r\n    mobile: '800×600px ou 4:3',\r\n};\r\n\r\nconst USE_SUPABASE = process.env.NEXT_PUBLIC_USE_SUPABASE === 'true';\r\n\r\nfunction ResolvedBannerImage({ src, alt }: { src: string; alt: string }) {\r\n    const { url } = useStorageImage('banner-images', src, { preferSigned: false });\r\n    return (\r\n        <img\r\n            src={url || src}\r\n            alt={alt}\r\n            loading=\"lazy\"\r\n            className=\"h-32 w-full object-cover object-center\"\r\n        />\r\n    );\r\n}\r\n\r\nexport default function AdminBanners() {\r\n    const { banners, setBanners, refreshBanners } = useApp();\r\n    const { showToast } = useToast();\r\n    const [allBanners, setAllBanners] = useState<Banner[]>([]);\r\n    const [bannerTitle, setBannerTitle] = useState('');\r\n    const [bannerFile, setBannerFile] = useState<File | null>(null);\r\n    const [previewUrl, setPreviewUrl] = useState<string | null>(null);\r\n    const [submitting, setSubmitting] = useState(false);\r\n    const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n    const loadAll = useCallback(async () => {\r\n        if (!USE_SUPABASE) {\r\n            setAllBanners([]);\r\n            return;\r\n        }\r\n        try {\r\n            const res = await fetch('/api/admin/banners', { credentials: 'include', cache: 'no-store' });\r\n            if (!res.ok) {\r\n                setAllBanners([]);\r\n                return;\r\n            }\r\n            const data = await res.json();\r\n            const list = Array.isArray(data.banners) ? data.banners : [];\r\n            setAllBanners(list);\r\n        } catch {\r\n            setAllBanners([]);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (USE_SUPABASE) {\r\n            loadAll();\r\n        }\r\n    }, [loadAll]);\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            if (previewUrl) URL.revokeObjectURL(previewUrl);\r\n        };\r\n    }, [previewUrl]);\r\n\r\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) return;\r\n        if (!file.type.startsWith('image/')) {\r\n            showToast({ variant: 'error', title: 'Ficheiro inválido', description: 'Selecione uma imagem (JPEG, PNG, WebP).' });\r\n            return;\r\n        }\r\n        if (previewUrl) URL.revokeObjectURL(previewUrl);\r\n        setBannerFile(file);\r\n        setPreviewUrl(URL.createObjectURL(file));\r\n    };\r\n\r\n    const resetForm = () => {\r\n        setBannerTitle('');\r\n        setBannerFile(null);\r\n        if (previewUrl) URL.revokeObjectURL(previewUrl);\r\n        setPreviewUrl(null);\r\n        if (fileInputRef.current) fileInputRef.current.value = '';\r\n    };\r\n\r\n    const addBanner = async () => {\r\n        if (!bannerFile && !previewUrl) return;\r\n\r\n        if (USE_SUPABASE) {\r\n            if (!bannerFile) {\r\n                showToast({ variant: 'error', title: 'Sem ficheiro', description: 'Selecione uma imagem para o banner.' });\r\n                return;\r\n            }\r\n\r\n            setSubmitting(true);\r\n            try {\r\n                // Use a nova API segura (server-side) em vez do repo.create (client-side)\r\n                const formData = new FormData();\r\n                formData.append('file', bannerFile);\r\n                formData.append('title', bannerTitle.trim());\r\n                formData.append('active', 'true');\r\n                formData.append('order', allBanners.length.toString());\r\n\r\n                const response = await fetch('/api/admin/banners', {\r\n                    method: 'POST',\r\n                    body: formData,\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    const errorText = await response.text();\r\n                    let errorMessage = 'Falha no servidor';\r\n                    try {\r\n                        const errorJson = JSON.parse(errorText);\r\n                        errorMessage = errorJson.details || errorJson.error || errorMessage;\r\n                    } catch {\r\n                        errorMessage = `Erro ${response.status}: ${errorText || response.statusText}`;\r\n                    }\r\n                    throw new Error(errorMessage);\r\n                }\r\n\r\n                await refreshBanners();\r\n                await loadAll();\r\n                resetForm();\r\n\r\n                showToast({\r\n                    variant: 'success',\r\n                    title: 'Banner publicado',\r\n                    description: 'O banner foi enviado com sucesso via servidor.',\r\n                });\r\n            } catch (err: any) {\r\n                console.error('[ADMIN/BANNERS] Add error:', err);\r\n                showToast({\r\n                    variant: 'error',\r\n                    title: 'Erro ao publicar banner',\r\n                    description: err.message || 'Erro desconhecido',\r\n                });\r\n            } finally {\r\n                setSubmitting(false);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (bannerFile) {\r\n            const dataUrl = await fileToDataUrl(bannerFile);\r\n            const newBanner: Banner = {\r\n                id: crypto.randomUUID(),\r\n                imageUrl: dataUrl,\r\n                title: bannerTitle.trim() || undefined,\r\n                active: true,\r\n                order: banners.length,\r\n                createdAt: new Date().toISOString(),\r\n            };\r\n            setBanners((prev) => [...prev, newBanner]);\r\n            resetForm();\r\n        }\r\n    };\r\n\r\n    const toggleBannerActive = async (b: Banner) => {\r\n        if (USE_SUPABASE) {\r\n            setSubmitting(true);\r\n            try {\r\n                const formData = new FormData();\r\n                formData.append('id', b.id);\r\n                formData.append('active', (!b.active).toString());\r\n\r\n                const response = await fetch('/api/admin/banners', {\r\n                    method: 'PATCH',\r\n                    body: formData,\r\n                });\r\n\r\n                if (!response.ok) throw new Error('Falha ao atualizar banner no servidor');\r\n\r\n                await refreshBanners();\r\n                await loadAll();\r\n                showToast({\r\n                    variant: 'success',\r\n                    title: 'Banner atualizado',\r\n                    description: 'O estado do banner foi atualizado com sucesso.',\r\n                });\r\n            } catch (err: any) {\r\n                showToast({\r\n                    variant: 'error',\r\n                    title: 'Erro ao atualizar banner',\r\n                    description: err.message || 'Erro desconhecido',\r\n                });\r\n            } finally {\r\n                setSubmitting(false);\r\n            }\r\n        } else {\r\n            setBanners((prev) => prev.map((x) => (x.id === b.id ? { ...x, active: !x.active } : x)));\r\n        }\r\n    };\r\n\r\n    const [bannerToDelete, setBannerToDelete] = useState<Banner | null>(null);\r\n\r\n    const handleConfirmDeleteBanner = async () => {\r\n        if (!bannerToDelete) return;\r\n        const id = bannerToDelete.id;\r\n        if (USE_SUPABASE) {\r\n            setSubmitting(true);\r\n            try {\r\n                const res = await fetch(`/api/admin/banners/${id}`, {\r\n                    method: 'DELETE',\r\n                    credentials: 'include',\r\n                });\r\n                const body = await res.json().catch(() => ({}));\r\n                if (!res.ok) {\r\n                    throw new Error(body?.error || res.statusText || 'Erro ao remover');\r\n                }\r\n                setAllBanners((prev) => prev.filter((b) => b.id !== id));\r\n                await refreshBanners();\r\n                await loadAll();\r\n                showToast({\r\n                    variant: 'success',\r\n                    title: 'Banner removido',\r\n                    description: 'O banner foi removido com sucesso.',\r\n                });\r\n            } catch (err) {\r\n                showToast({\r\n                    variant: 'error',\r\n                    title: 'Erro ao remover banner',\r\n                    description: err instanceof Error ? err.message : getMessageForError(err),\r\n                });\r\n            } finally {\r\n                setSubmitting(false);\r\n            }\r\n        } else {\r\n            setBanners((prev) => prev.filter((x) => x.id !== bannerToDelete.id));\r\n        }\r\n        setBannerToDelete(null);\r\n    };\r\n\r\n    const listToShow = USE_SUPABASE ? allBanners : banners;\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <ConfirmDialog\r\n                open={!!bannerToDelete}\r\n                onOpenChange={(open) => !open && setBannerToDelete(null)}\r\n                title=\"Remover banner\"\r\n                description=\"Tem certeza que deseja remover este banner? Esta ação não pode ser desfeita.\"\r\n                confirmLabel=\"Remover\"\r\n                cancelLabel=\"Cancelar\"\r\n                onConfirm={handleConfirmDeleteBanner}\r\n                destructive\r\n            />\r\n            <div>\r\n                <h2 className=\"text-lg font-semibold\">Banners</h2>\r\n                <p className=\"text-sm text-muted-foreground\">\r\n                    Upload de imagem para a página inicial. Desktop: imagem em destaque (crop). Mobile: imagem completa visível.\r\n                </p>\r\n            </div>\r\n\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2 text-base\">\r\n                        <ImagePlus className=\"h-4 w-4\" />\r\n                        Novo banner\r\n                    </CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-4\">\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                        Recomendado: Desktop {RESOLUTIONS.desktop}, Mobile {RESOLUTIONS.mobile}. A imagem será ajustada automaticamente em cada dispositivo.\r\n                    </p>\r\n                    <div className=\"space-y-2\">\r\n                        <Label>Upload da imagem</Label>\r\n                        <input\r\n                            ref={fileInputRef}\r\n                            type=\"file\"\r\n                            accept=\"image/jpeg,image/png,image/webp\"\r\n                            onChange={handleFileChange}\r\n                            className=\"block w-full text-sm text-muted-foreground file:mr-4 file:rounded-md file:border-0 file:bg-primary file:px-4 file:py-2 file:text-sm file:font-medium file:text-primary-foreground file:hover:bg-primary/90\"\r\n                        />\r\n                        {previewUrl && (\r\n                            <div className=\"relative mt-2 h-24 w-full max-w-xs overflow-hidden rounded-lg border bg-muted\">\r\n                                <img\r\n                                    src={previewUrl}\r\n                                    alt=\"Pré-visualização\"\r\n                                    loading=\"lazy\"\r\n                                    className=\"h-full w-full object-cover object-center\"\r\n                                />\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                        <Label htmlFor=\"banner-title\">Título (opcional)</Label>\r\n                        <Input\r\n                            id=\"banner-title\"\r\n                            type=\"text\"\r\n                            value={bannerTitle}\r\n                            onChange={(e) => setBannerTitle(e.target.value)}\r\n                            placeholder=\"Título do banner\"\r\n                        />\r\n                    </div>\r\n                    <AppButton\r\n                        variant=\"primary\"\r\n                        onClick={addBanner}\r\n                        className=\"gap-2\"\r\n                        disabled={(!bannerFile && !previewUrl) || submitting}\r\n                    >\r\n                        {submitting ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Upload className=\"h-4 w-4\" />}\r\n                        Adicionar banner\r\n                    </AppButton>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle className=\"text-base\">Banners atuais</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    {listToShow.length === 0 ? (\r\n                        <p className=\"py-8 text-center text-muted-foreground\">Nenhum banner.</p>\r\n                    ) : (\r\n                        <ul className=\"space-y-4\">\r\n                            {listToShow.map((b) => (\r\n                                <li key={b.id} className=\"overflow-hidden rounded-lg border\">\r\n                                    <ResolvedBannerImage src={b.imageUrl} alt={b.title || 'Banner'} />\r\n                                    <div className=\"flex items-center justify-between p-3\">\r\n                                        <span className=\"text-sm text-muted-foreground\">\r\n                                            {b.title || 'Sem título'}\r\n                                        </span>\r\n                                        <div className=\"flex gap-2\">\r\n                                            <AppButton\r\n                                                size=\"sm\"\r\n                                                variant={b.active ? 'primary' : 'secondary'}\r\n                                                onClick={() => toggleBannerActive(b)}\r\n                                                className=\"gap-1\"\r\n                                                disabled={submitting}\r\n                                            >\r\n                                                {b.active ? (\r\n                                                    <ToggleRight className=\"h-4 w-4\" />\r\n                                                ) : (\r\n                                                    <ToggleLeft className=\"h-4 w-4\" />\r\n                                                )}\r\n                                                {b.active ? 'Ativo' : 'Inativo'}\r\n                                            </AppButton>\r\n                                            <AppButton\r\n                                                size=\"sm\"\r\n                                                variant=\"destructive\"\r\n                                                onClick={() => setBannerToDelete(b)}\r\n                                                className=\"gap-1\"\r\n                                                disabled={submitting}\r\n                                            >\r\n                                                <Trash2 className=\"h-4 w-4\" />\r\n                                                Remover\r\n                                            </AppButton>\r\n                                        </div>\r\n                                    </div>\r\n                                </li>\r\n                            ))}\r\n                        </ul>\r\n                    )}\r\n                </CardContent>\r\n            </Card>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction fileToDataUrl(file: File): Promise<string> {\r\n    return new Promise((resolve, reject) => {\r\n        const reader = new FileReader();\r\n        reader.onload = () => resolve(reader.result as string);\r\n        reader.onerror = () => reject(new Error('Falha ao ler o ficheiro de imagem.'));\r\n        reader.readAsDataURL(file);\r\n    });\r\n}\r\n"],"names":[],"mappings":"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"}}]
}